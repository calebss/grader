/**
 * @module
 * @author ftheomunhoz
 * @description
 *
 */

module.exports = function (app, swaggerNode, config) {
    swaggerNode.setApiInfo(config);

    swaggerNode.configureSwaggerPaths("", config.swaggerDoc, "");
    swaggerNode.configure(config.basePath || '/', config.version || '1.0.0');

    var docs_handler = require('express').static('./node_modules/node-swagger-ui/public/swagger/');
    app.get(/^\/docs(\/.*)?$/, function (req, res, next) {
        if (req.url === config.url) {
            res.writeHead(302, {'Location': req.url + '/'});
            res.end();
            return;
        }

        req.url = req.url.substr(('/' + config.url).replace('//', '/').length);
        return docs_handler(req, res, next);
    });
};